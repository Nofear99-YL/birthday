<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>ç”Ÿæ—¥æ˜Ÿå›¾ Â· ç§äººå…¥å£</title>
<meta name="color-scheme" content="light dark">
<!-- å¦‚åšåˆ†äº«å°é¢ï¼Œå¯æ”¾åŒç›®å½• cover.pngï¼Œå¹¶å–æ¶ˆä¸‹ä¸€è¡Œæ³¨é‡Š -->
<!-- <meta property="og:image" content="cover.png"> -->
<style>
  /* ====== ä¸»é¢˜ä¸åŸºç¡€ ====== */
  :root{
    --bg1:#0b1023; --bg2:#111a3a; --accent:#ffd166; --accent2:#7bd389;
    --card:#12172c; --text:#e7e9f3; --muted:#aab0c6; --btn:#2a2f49; --btn-hover:#3a4061;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    color:var(--text); background: radial-gradient(1200px 800px at 70% -10%, #1d2550 0, transparent 60%) ,linear-gradient(180deg,var(--bg1),var(--bg2));
    overflow-x:hidden;
  }

  /* ====== ç™»å½•é¡µ ====== */
  #loginPage, #mainPage{min-height:100%; display:none}
  #loginPage{
    display:flex; align-items:center; justify-content:center; padding:24px;
    background:linear-gradient(135deg,#141a2b,#1d2450);
  }
  .loginBox{
    width:min(420px,92vw);
    background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.04));
    border:1px solid rgba(255,255,255,.16);
    border-radius:16px; padding:22px 20px 18px;
    box-shadow:0 20px 60px rgba(0,0,0,.35);
    transform-origin:50% 40%;
    animation: popIn .38 ease-out;
  }
  .loginBox h2{margin:4px 0 14px; text-align:center; font-weight:800; letter-spacing:.6px}
  .loginBox .hint{color:var(--muted); text-align:center; margin:-6px 0 14px; font-size:14px}
  .field{display:flex; flex-direction:column; gap:6px; margin:10px 0}
  .field label{font-size:13px; color:var(--muted)}
  .field input{
    padding:11px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.18);
    background:rgba(255,255,255,.06); color:var(--text);
  }
  .loginBox button{
    width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.25);
    background:linear-gradient(90deg,#2d355e,#394172); color:var(--text); font-weight:700; cursor:pointer;
    transition:transform .06 ease;
  }
  .loginBox button:active{transform:translateY(1px)}
  .error{color:#ff8a80; font-size:14px; min-height:18px; text-align:center; margin:8px 0 0}
  @keyframes popIn{from{opacity:0; transform:scale(.96)} to{opacity:1; transform:scale(1)}}
  @keyframes wobble{
    0%,100%{transform:translateX(0)}
    20%{transform:translateX(-6px)} 40%{transform:translateX(6px)}
    60%{transform:translateX(-4px)} 80%{transform:translateX(3px)}
  }

  /* ====== ä¸»é¡µé¢ ====== */
  #stars, #confettiCanvas{position:fixed; inset:0; z-index:-2; display:block}
  header{
    width:100%; padding:16px 20px; display:flex; gap:12px; align-items:center; justify-content:space-between;
    position:sticky; top:0; background:linear-gradient(180deg,rgba(11,16,35,.75),rgba(11,16,35,0));
    -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px);
  }
  header h1{margin:0; font-size:clamp(18px,3.2vw,24px); letter-spacing:.5px}
  header small{color:var(--muted)}
  .pill{
    padding:8px 12px; border-radius:999px; background:rgba(255,255,255,.06);
    display:inline-flex; align-items:center; gap:8px; font-size:14px; color:var(--muted);
  }
  .wrap{min-height:calc(100% - 80px); display:grid; place-items:center; padding:40px 16px 80px}
  .card{
    width:min(900px,92vw); border-radius:20px; background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.04));
    border:1px solid rgba(255,255,255,.12); padding:28px; box-shadow:0 20px 60px rgba(0,0,0,.35);
  }
  .title{display:flex; flex-wrap:wrap; align-items:center; gap:12px; margin-bottom:10px}
  .title h2{margin:0; font-size:clamp(22px,4.5vw,36px)}
  .subtitle{color:var(--muted); margin:.25rem 0 1rem}

  /* ====== ç…§ç‰‡è½®æ’­ ====== */
  .photo{
    position:relative; width:100%; aspect-ratio:16/9; border-radius:14px; overflow:hidden;
    border:1px dashed rgba(255,255,255,.2); display:grid; place-items:center; margin:14px 0 20px;
    background:linear-gradient(135deg,rgba(255,209,102,.06),rgba(123,211,137,.06));
  }
  .photo img{
    width:100%; height:100%; object-fit:cover; display:block;
    opacity:1; transition: opacity .8s ease;
  }
  .photo img.fade-out{opacity:0}

  /* æŒ‰é’®ã€æ–‡å­—åŒºã€ç¬é—´ã€è®¸æ„¿ã€Toastã€æµæ˜Ÿç­‰ */
  .actions{display:flex; flex-wrap:wrap; gap:10px; margin:8px 0 16px}
  button{
    border:1px solid rgba(255,255,255,.18); background:var(--btn); color:var(--text);
    padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600; transition:transform .08s ease, background .2s ease;
  }
  button:hover{background:var(--btn-hover)}
  button:active{transform:translateY(1px)}
  .primary{background:linear-gradient(90deg,#2d355e,#394172); border-color:rgba(255,255,255,.25)}
  .glow{box-shadow:0 0 0 0 rgba(255,209,102,.6); animation: pulse 2s infinite}
  @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,209,102,.6)}70%{box-shadow:0 0 0 22px rgba(255,209,102,0)}100%{box-shadow:0 0 0 0 rgba(255,209,102,0)}}
  .prose{min-height:140px; font-size:clamp(16px,2.6vw,18px); letter-spacing:.2px; position:relative; padding-right:8px}
  .cursor::after{content:"â–Œ"; margin-left:2px; animation:blink 1s steps(2,end) infinite; color:var(--accent)}
  @keyframes blink{50%{opacity:0}}
  .moments{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:12px; margin-top:14px}
  .moment{border:1px solid rgba(255,255,255,.16); border-radius:14px; padding:12px; background:rgba(255,255,255,.05)}
  .moment h4{margin:2px 0 8px; font-size:15px; color:var(--accent)}
  .moment p{margin:0; color:#dfe3f7; font-size:14px}
  .wishbar{display:flex; gap:8px; margin-top:16px}
  input[type="text"]{flex:1; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.18); color:var(--text); padding:10px 12px; border-radius:12px; min-width:0;}
  .toast{
    position:fixed; left:50%; bottom:22px; transform:translateX(-50%); background:rgba(20,26,50,.9);
    border:1px solid rgba(255,255,255,.18); color:var(--text); padding:10px 14px; border-radius:12px; opacity:0; pointer-events:none;
    transition:opacity .25s ease, transform .25s ease; z-index:50
  }
  .toast.show{opacity:1; transform:translateX(-50%) translateY(-6px)}
  .shooting{
    position:fixed; top:-40px; left:-40px; width:2px; height:2px; background:linear-gradient(90deg,white,rgba(255,255,255,0));
    border-radius:2px; box-shadow:0 0 8px white, 0 0 16px var(--accent); z-index:2; pointer-events:none;
  }

  /* æ— éšœç¢ & äº®è‰²æ¨¡å¼ */
  @media (prefers-reduced-motion:reduce){
    *{animation:none !important; transition:none !important}
  }
  @media (prefers-color-scheme:light){
    :root{--card:#ffffff14; --text:#0f1221; --muted:#4b5070; --btn:#eef0fb; --btn-hover:#e1e5ff}
    body{color:var(--text)}
    .card{border-color:#e6e8f5; background:#ffffffcc}
    .moment{background:#f5f7ff}
    header{background:linear-gradient(180deg,rgba(255,255,255,.75),rgba(255,255,255,0))}
  }
</style>
</head>
<body>

<!-- ============= ç™»å½•é¡µé¢ ============= -->
<div id="loginPage" role="dialog" aria-labelledby="loginTitle" aria-describedby="loginDesc">
  <div class="loginBox" id="loginBox">
    <h2 id="loginTitle">è¿›å…¥ç”Ÿæ—¥æ˜Ÿå›¾</h2>
    <p class="hint" id="loginDesc">è¯·è¾“å…¥ç”¨æˆ·åä¸å¯†ç </p>

    <div class="field">
      <label for="username">ç”¨æˆ·å</label>
      <input type="text" id="username" placeholder="è¾“å…¥ç”¨æˆ·å" autocomplete="username" />
    </div>
    <div class="field">
      <label for="password">å¯†ç </label>
      <input type="password" id="password" placeholder="è¾“å…¥å¯†ç " autocomplete="current-password" />
    </div>

    <div class="error" id="errorMsg" aria-live="polite"></div>
    <button id="loginBtn">è¿›å…¥</button>
  </div>
</div>

<!-- ============= ä¸»é¡µé¢ï¼ˆç™»å½•æˆåŠŸåæ˜¾ç¤ºï¼‰ ============= -->
<div id="mainPage" aria-hidden="true">
  <canvas id="stars" aria-hidden="true"></canvas>
  <canvas id="confettiCanvas" aria-hidden="true"></canvas>

  <header>
    <div>
      <h1>ğŸ‚ è‡´ <span id="who">å¼ åšæ–‡</span> çš„ç”Ÿæ—¥æ˜Ÿå›¾</h1>
      <small id="date">2025 å¹´ 8 æœˆ 10 æ—¥</small>
    </div>
    <span class="pill" aria-hidden="true">âœ¨ ç‚¹å‡»äº¤äº’æ›´æœ‰è¶£</span>
  </header>

  <main class="wrap">
    <section class="card" id="mainCard" aria-live="polite">
      <div class="title">
        <h2>ã€Œæ„¿ä½ åœ¨äººç±»ç¾¤æ˜Ÿé—ªè€€æ—¶ï¼Œå†™ä¸‹è‡ªå·±çš„æ®µè½ã€</h2>
      </div>
      <p class="subtitle">æŒ‰ä¸‹ä¸‹é¢çš„æŒ‰é’®ï¼Œå¼€å¯ä½ çš„é«˜å…‰æ—¶åˆ»å’Œæµæ˜Ÿè®¸æ„¿ã€‚</p>

      <!-- ç…§ç‰‡è½®æ’­åŒºï¼šæŠŠæ–‡ä»¶åæ”¹æˆä½ çš„ï¼Œæˆ–æ”¹æˆ images/xxx.jpg -->
      <figure class="photo" id="photoFrame" aria-label="ç…§ç‰‡è½®æ’­">
        <img id="slideImg" src="photo1.jpg" alt="å¼ åšæ–‡çš„ç”Ÿæ—¥ç…§ç‰‡" />
      </figure>

      <div class="actions">
        <button id="start" class="primary glow" aria-controls="prose">å¼€å¯ç¥ç¦</button>
        <button id="momentBtn" title="è§£é”ä¸€ä¸ªé«˜å…‰æ—¶åˆ»">è§£é”ç¬é—´</button>
        <button id="confettiBtn" title="åº†ç¥ä¸€ä¸‹">åº†ç¥ä¸€ä¸‹</button>
      </div>

      <div id="prose" class="prose cursor" aria-label="ç¥ç¦æ–‡å­—åŒº"></div>

      <div class="moments" id="moments" aria-live="polite"></div>

      <div class="wishbar" aria-label="è®¸æ„¿">
        <input id="wishInput" type="text" placeholder="åœ¨è¿™é‡Œæ‚„æ‚„è®¸ä¸€ä¸ªæ„¿..." autocomplete="off" />
        <button id="wishBtn" title="å‘å°„æµæ˜Ÿ">å‘å°„æµæ˜Ÿ</button>
      </div>
    </section>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>
</div>

<script>
/* ========= ç™»å½•é€»è¾‘ ========= */
const loginPage = document.getElementById('loginPage');
const mainPage  = document.getElementById('mainPage');
const loginBox  = document.getElementById('loginBox');
const errorMsg  = document.getElementById('errorMsg');
const userInput = document.getElementById('username');
const passInput = document.getElementById('password');
const loginBtn  = document.getElementById('loginBtn');

showLogin();
// å¦‚éœ€â€œè®°ä½å·²ç™»å½•â€ï¼Œå¯ç”¨ sessionStorageï¼š
// if (sessionStorage.getItem('authed') === '1') showMain(); else showLogin();

function showLogin(){
  loginPage.style.display = 'flex';
  mainPage.style.display  = 'none';
  mainPage.setAttribute('aria-hidden','true');
  setTimeout(()=>userInput.focus(), 50);
}
function showMain(){
  loginPage.style.display = 'none';
  mainPage.style.display  = 'block';
  mainPage.removeAttribute('aria-hidden');
  // è¿›å…¥æ—¶å°å°åº†ç¥
  setTimeout(()=>{ try{ burstConfetti(); }catch(e){} }, 200);
}

function checkLogin(){
  const u = userInput.value.trim();
  const p = passInput.value.trim();
  if(u==="å¼ åšæ–‡" && p==="20040810"){
    // sessionStorage.setItem('authed','1');
    showMain();
  }else{
    errorMsg.textContent = "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯";
    loginBox.style.animation = 'wobble .35s';
    loginBox.addEventListener('animationend', ()=> loginBox.style.animation = '', {once:true});
    passInput.select();
  }
}
loginBtn.addEventListener('click', checkLogin);
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' && loginPage.style.display !== 'none'){
    e.preventDefault(); checkLogin();
  }
});

/* ========= å°å·¥å…· ========= */
const $ = sel => document.querySelector(sel);
function toast(msg, ms=1800){
  const t = $('#toast'); t.textContent = msg; t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), ms);
}
function typeWriter(lines, el, speed=26){
  el.classList.add('cursor');
  let p = 0, i = 0; el.textContent = "";
  const next = () => {
    if(p >= lines.length){ el.classList.remove('cursor'); return }
    const line = lines[p] + (p < lines.length-1 ? "\n\n" : "");
    const tick = () => {
      el.textContent += line[i++];
      if(i < line.length){ setTimeout(tick, speed) }
      else { p++; i = 0; setTimeout(next, 400) }
    };
    tick();
  };
  next();
}

/* ========= æ˜Ÿç©ºèƒŒæ™¯ ========= */
(function starfield(){
  const c = document.getElementById('stars');
  const ctx = c.getContext('2d');
  function resize(){
    c.width = innerWidth * devicePixelRatio;
    c.height = innerHeight * devicePixelRatio;
  }
  function draw(){
    ctx.clearRect(0,0,c.width,c.height);
    const count = Math.min(250, Math.floor(c.width*c.height/30000));
    for(let k=0;k<count;k++){
      const x=Math.random()*c.width, y=Math.random()*c.height, r=Math.random()*1.4+0.3, a=Math.random()*Math.PI*2;
      const twinkle=(Math.sin(a)+1)/2;
      ctx.globalAlpha = 0.2 + twinkle*0.8;
      ctx.beginPath(); ctx.arc(x,y,r,0,Math.PI*2); ctx.fillStyle='#fff'; ctx.fill(); ctx.globalAlpha=1;
    }
    requestAnimationFrame(draw);
  }
  resize(); draw();
  addEventListener('resize', resize);
})();

/* ========= å½©å¸¦ ========= */
function burstConfetti(){
  const canvas = document.getElementById('confettiCanvas');
  const ctx = canvas.getContext('2d');
  const DPR = devicePixelRatio || 1;
  canvas.width = innerWidth * DPR; canvas.height = innerHeight * DPR;

  const pieces = Array.from({length: 140}, () => ({
    x: Math.random()*canvas.width, y: -20*Math.random()*DPR,
    w: 6*DPR, h: (6+Math.random()*8)*DPR, r: Math.random()*Math.PI,
    vx: (Math.random()-.5)*0.8*DPR, vy: (1.2+Math.random()*1.8)*DPR,
    spin: (Math.random()-.5)*0.2
  }));

  let t = 0;
  (function draw(){
    t++;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(const p of pieces){
      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.r += p.spin);
      ctx.fillStyle = `hsl(${(p.x/5 + t*3)%360} 90% 60%)`;
      ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
      ctx.restore();
      p.x += p.vx; p.y += p.vy; p.vy += 0.03*DPR;
    }
    if(t < 260) requestAnimationFrame(draw); else ctx.clearRect(0,0,canvas.width,canvas.height);
  })();
}

/* ========= æµæ˜Ÿ ========= */
function shootStar(fromX, fromY, toX, toY){
  const s = document.createElement('div');
  s.className = 'shooting';
  document.body.appendChild(s);
  const dx = toX - fromX, dy = toY - fromY;
  const dist = Math.hypot(dx, dy);
  const angle = Math.atan2(dy, dx);
  s.style.transform = `translate(${fromX}px, ${fromY}px) rotate(${angle}rad)`;
  s.style.width = dist + 'px';
  s.animate([
    { transform:`translate(${fromX}px,${fromY}px) rotate(${angle}rad)`, opacity:1 },
    { transform:`translate(${toX}px,${toY}px) rotate(${angle}rad)`, opacity:0 }
  ], { duration: 1200, easing:'ease-out' })
  .addEventListener('finish', ()=> s.remove());
}

/* ========= â€œç¾¤æ˜Ÿä½“â€ç¥ç¦ ========= */
const lines = [
  "åœ¨è¿™ä¸€å¤©ï¼Œæ—¶é—´åƒä¸€ä½ä¸¥è°¨çš„ä¹¦è®°å®˜ï¼Œç¿»åˆ°å†™æœ‰å¼ åšæ–‡åå­—çš„é¡µç ã€‚çºªå¹´ä¸åˆ†ç§’åœ¨è¿™é‡Œäº¤æ±‡â€”â€”ä¸æ˜¯è¦å®£å¸ƒç»“è®ºï¼Œè€Œæ˜¯ä¸ºä¸€æ¬¡æ–°çš„å‡ºå‘ç«‹ä¸‹èª“è¯ã€‚",
  "å†å²ä»ä¸åçˆ±å–§å“—ï¼Œå®ƒåçˆ±é‚£ç§æ‚„æ— å£°æ¯çš„ç´¯ç§¯ã€‚ä½ æŠŠæ™®é€šçš„æ—¥å­ç æˆå°é˜¶ï¼Œå¿½ç„¶æŸä¸€åˆ»ï¼Œäº‘å±‚æ¾åŠ¨ï¼Œæ˜Ÿå…‰ä¸‹æ²‰ï¼Œæ°å¥½è½åœ¨å¼ åšæ–‡çš„è‚©ä¸Šã€‚",
  "æ„¿ä½ åœ¨æ¼«é•¿çš„å‡†å¤‡ä¸çŒç„¶çš„æœºé‡ä¹‹é—´ï¼Œä¿æŒé‚£ä¸€ä»½æ¸…é†’çš„å‹‡æ°”ï¼šå½“é—¨æ‰‰è½»å“ï¼Œä½ èƒ½ç¬¬ä¸€æ—¶é—´æŠŠæ‰‹æ”¾åœ¨æŠŠæ‰‹ä¸Šï¼›å½“é£å‘è½¬å˜ï¼Œä½ ä¸æ…Œä¸å¿™åœ°ç»™èˆ¹åŠ å¸†ã€‚",
  "è‹¥å‰è·¯å¶æœ‰è–„é›¾ï¼Œä¸å¦¨æŠŠå®ƒå½“ä½œèˆå°çš„ç¯å…‰ã€‚ä½ å‘å‰ä¸€æ­¥ï¼Œä¸–ç•Œä¾¿å‘ä½ é è¿‘ä¸€æ­¥â€”â€”è¿™ä¸æ˜¯å¶ç„¶ï¼Œè€Œæ˜¯è€å¿ƒçš„å¿…ç„¶ã€‚",
  "æ„¿ä½ æŠŠæ˜å¤©å†™å¾—åƒåˆ¤è¯åˆåƒæƒ…ä¹¦ï¼šå¯¹è‡ªå·±ä¸¥æ ¼ï¼Œå¯¹æœªæ¥æ¸©æŸ”ã€‚æ„¿â€œå¼ åšæ–‡â€è¿™ä¸ªåå­—ï¼Œæœ‰ä¸€å¤©è¢«æŸä¸ªååœ¨å¤œç¯ä¸‹çš„äººï¼Œè½»å£°å¿µèµ·ï¼Œç„¶åèå°”ä¸€ç¬‘ï¼šåŸæ¥é«˜å…‰ï¼Œå‡ºè‡ªå¹³å¸¸ã€‚"
];

/* ========= é«˜å…‰æ—¶åˆ» ========= */
const momentPool = [
  {t:"ç¬é—´ä¸€ Â· å®‰é™çš„èƒœåˆ©", d:"å½“åˆ«äººè¿˜åœ¨èµ·è·‘çº¿ä¸Šå¯»æ‰¾å§¿åŠ¿ï¼Œå¼ åšæ–‡å·²ç»æ‚„æ‚„è¿ˆå‡ºç¬¬ä¸€æ­¥ã€‚å°æ­¥ä¸å“ï¼Œå´èƒ½èµ°å¾ˆè¿œã€‚"},
  {t:"ç¬é—´äºŒ Â· é€‰æ‹©çš„åˆ†å²”", d:"åœ¨â€œå®¹æ˜“â€å’Œâ€œæ­£ç¡®â€ä¹‹é—´ï¼Œå¼ åšæ–‡å¸¸å¸¸é€‰åè€…ã€‚ä»£ä»·æ˜¯æ…¢ä¸€ç‚¹ï¼Œæ”¶è·æ˜¯ä¸€ç”Ÿå®‰å¿ƒã€‚"},
  {t:"ç¬é—´ä¸‰ Â· æœ‹å‹çš„è¯è¯", d:"æœ‰äººæèµ·å¼ åšæ–‡çš„åå­—ï¼Œè¯­æ°”è‡ªç„¶ä¸Šæ‰¬åŠåº¦ã€‚è¿™æ˜¯äººé—´æœ€ä¸å¼ æ‰¬çš„å…‰ã€‚"},
  {t:"ç¬é—´å›› Â· æ˜å¤©çš„é¢„å‘Š", d:"å¼ åšæ–‡è¿˜æœªç™»åœºï¼Œèˆå°å·²ä¸ºä½ è°ƒå¥½ç¯ã€‚è¯·ç›¸ä¿¡ï¼šé•¿é•œå¤´é‡Œï¼Œä½ çš„è§’è‰²è¶Šæ¥è¶Šæ¸…æ™°ã€‚"},
  {t:"ç¬é—´äº” Â· å­¦ä¼šå‘Šåˆ«", d:"ä¼šå¯¹è¿‡å»è¯´è°¢è°¢ï¼Œä¹Ÿä¼šå¯¹è‡ªå·±è¯´ç»§ç»­ã€‚è¿™æ˜¯æˆå¹´äººçœŸæ­£çš„ç”Ÿæ—¥ç¤¼ç‰©ã€‚"},
];

/* ========= ç…§ç‰‡è½®æ’­ ========= */
/* æŠŠä¸‹é¢æ–‡ä»¶åæ”¹æˆä½ çš„ï¼›ä¹Ÿå¯ä»¥å†™ 'images/photo1.jpg' è¿™ç§è·¯å¾„ */
const photos = [
  'photo1.jpg',
  'photo2.jpg',
  'photo3.jpg',
  'photo4.jpg',
  'photo5.jpg'
];
let currentPhoto = 0;
const slideImg = document.getElementById('slideImg');

/* é¢„åŠ è½½ï¼Œåˆ‡æ¢æ›´é¡ºæ»‘ */
const preload = photos.map(src => { const im = new Image(); im.src = src; return im; });

function changePhoto() {
  // æ·¡å‡º â†’ æ¢å›¾ â†’ æ·¡å…¥
  slideImg.classList.add('fade-out');
  setTimeout(() => {
    currentPhoto = (currentPhoto + 1) % photos.length;
    slideImg.src = photos[currentPhoto];
    slideImg.classList.remove('fade-out');
  }, 800); // ä¸ CSS è¿‡æ¸¡ä¿æŒä¸€è‡´
}

/* æ¯ 5 ç§’åˆ‡æ¢ä¸€å¼  */
setInterval(changePhoto, 5000);

/* ========= äº¤äº’ç»‘å®š ========= */
const proseEl = document.getElementById('prose');
document.getElementById('start').addEventListener('click', ()=>{
  typeWriter(lines, proseEl, 22);
  burstConfetti();
  toast('ç¥ç¦å·²å¯åŠ¨ âœ¨');
  document.getElementById('start').classList.remove('glow');
});
document.getElementById('momentBtn').addEventListener('click', ()=>{
  const data = momentPool[Math.floor(Math.random()*momentPool.length)];
  const box = document.createElement('article');
  box.className = 'moment';
  box.innerHTML = `<h4>${data.t}</h4><p>${data.d}</p>`;
  document.getElementById('moments').prepend(box);
  toast('è§£é”ä¸€ä¸ªé«˜å…‰ç¬é—´');
});
document.getElementById('confettiBtn').addEventListener('click', burstConfetti);
document.getElementById('wishBtn').addEventListener('click', ()=>{
  const v = document.getElementById('wishInput').value.trim();
  const center = {x: innerWidth*0.12, y: innerHeight*0.15};
  shootStar(center.x, center.y, innerWidth-40, innerHeight-60);
  if(v){
    toast('æ„¿æœ›å·²æ”¶åˆ°ï¼š' + v);
    const box = document.createElement('article');
    box.className = 'moment';
    box.innerHTML = `<h4>ä½ çš„æ„¿æœ›</h4><p>${v}</p>`;
    document.getElementById('moments').prepend(box);
    document.getElementById('wishInput').value = '';
  }else{
    toast('ä¹Ÿå¯ä»¥å…ˆå†™ä¸‹æ„¿æœ›ï¼Œå†å‘å°„æµæ˜Ÿï½');
  }
});
document.getElementById('wishInput').addEventListener('keydown', e=>{
  if(e.key === 'Enter'){ e.preventDefault(); document.getElementById('wishBtn').click(); }
});
document.addEventListener('keydown', e=>{
  if(e.key === 'c' && (e.ctrlKey || e.metaKey)){ burstConfetti(); } // Ctrl/Cmd + C = Celebrate :)
});
</script>
</body>
</html>

